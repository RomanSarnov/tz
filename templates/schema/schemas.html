{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>New Schema</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/schema.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">

</head>
<body>
<header>
    <div class="container-fluid" style="padding-left: 65px; margin-top: 16px">
        <div class="row">
            <div class="col-1">
                <h5>FakeCSV</h5>
            </div>
            <div class="col-9">
                Schemas
            </div>
            <div class="col-1">
                Hello, {{ request.user.username|default:"username" }}
            </div>
            <div class="col-1">
                <a href="{% url 'logout' %}" style="text-decoration: none;color: rgba(0, 0, 0, 0.3)">Logout</a>
            </div>
        </div>
    </div>
</header>
<div class="container-fluid">
    <div class="row" style="margin-top: 30px; padding-left: 65px">
        <div class="col-1">
            <h5>New Schema</h5>
        </div>

    </div>
    <div class="row" style="margin-top: 15px; padding-left: 65px">
        <div class="col-4">
            <label class="label-input-new-schema">Name</label>
            <input type="text" class="input-new-schema">
        </div>
        <div class="col-4">
        </div>
        <div class="col-2">
            <button class="btn btn-primary">Submit</button>
        </div>
    </div>
    <div class="row" style="margin-top: 15px; padding-left: 65px">
        <div class="col-4">
            <label>
                Column separator
            </label>
            <select class="input-new-schema">
                <option value="Comma (,)">Comma (,)</option>
                <option value="Colon (;)">Colon (;)</option>
            </select>
        </div>
    </div>
    <div class="row" style="margin-top: 15px; padding-left: 65px">
        <div class="col-4">
            <label>
                String character
            </label>
            <select class="input-new-schema">
                <option value='Double-quote (")'>Double-quote (")</option>
                <option value="Quote (')">Quote (')</option>
            </select>
        </div>
    </div>
    <div class="row" style="margin-top: 25px;padding-left: 65px">
        <div class="col-4 columns" id="0">
            <h4>Schema columns
            </h4>
        </div>
    </div>
    <div class="add-column-block">
        <div class="row column-row">
            <div class="col-2 name-col">
                <label class="label-input-new-schema">Column name
                </label>
                <input type="text" class="input-new-column-name" id="name">
            </div>
            <div class="col-4">
                <label class="label-input-new-schema">Type</label>
                <select class="input-new-column-type" name="type" id="type">
                    <option value='Job'>Job</option>
                    <option value="Domain name">Domain name</option>
                    <option value="Phone Number">Phone Number</option>
                    <option value="Company">Company</option>
                    <option value="Integer">Integer</option>
                </select>
            </div>
            <div class="col-1">
                <label class="label-input-new-schema">Order</label>
                <input type="number" class="input-new-column-order">
            </div>
        </div>
        <div class="row column-row">
            <div class="col-1">
                <button class="btn btn-primary add-column" style="margin-top: 25px">Add column</button>

            </div>
        </div>
    </div>
</div>
</body>
<script>
    let addColumnButton = document.querySelector('.add-column')
    let columns = document.querySelector('.columns')
    addColumnButton.addEventListener('click', () => {
        let nameData = document.querySelector('#name')
        let typeData = document.querySelector('#type')
        if (typeData.value === "Integer") {
            let divType = document.createElement('div')
            divType.innerHTML = `<div class="col-4">
                <label class="label-input-new-schema">Type</label>
                <select class="input-new-column-type" name="type" id="type">
                    <option value='Job'>Job</option>
                    <option value="Domain name">Domain name</option>
                    <option value="Phone Number">Phone Number</option>
                    <option value="Company">Company</option>
                    <option value="Integer">Integer</option>
                </select>
            </div>`
            typeData.after(divType)
        }
        let div = document.createElement('div');
        div.className = "row column-row";
        div.style.marginTop = '25px'
        div.innerHTML = `<div class="col-2 name-col">
            <label class="label-input-new-schema">Column name</label>
            <input type="text" class="input-new-column-name" required id="name${columns.id}" value="${nameData.value}">
        </div>
        <div class="col-4">
            <label class="label-input-new-schema">Type</label>
            <select class="input-new-column-type" name="type" id="type${columns.id}" value="${typeData.value}">
                <option value='Job'>Job</option>
                <option value="Domain name">Domain name</option>
                <option value="Phone Number">Phone Number</option>
                <option value="Company">Company</option>
                <option value="Integer">Integer</option>
            </select>
        </div>
        <div class="col-1">
            <label class="label-input-new-schema">Order</label>
            <input type="number" class="input-new-column-order" value="${columns.id}">
        </div>`;
        columns.after(div)
        let newTypeData = document.querySelector(`#type${columns.id}`)
        newTypeData.value = typeData.value
        columns.id = parseInt(columns.id) + 1
    })
</script>
</html>